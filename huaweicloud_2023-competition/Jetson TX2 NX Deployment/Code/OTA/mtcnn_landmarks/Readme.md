## MTCNN-Landmarks

* 目录结构

|-- detect.py：用于检测视频或者照片，命令行参数见文件中参数解析

|-- inferAPI.py：封装了对图片以及视频的推理，输入为路径，设备等

|-- infer_examples.py：调用接口示例

|-- infer_models：保存模型的目录

|-- models：网络模型代码

|-- test：infer_examples.py中的测试案例

|--utils：工具类包

* 环境依赖

与原环境一致，唯一多需要安装一个torchsummary包

* 运行

运行案例

~~~bash
python infer_example.py
~~~

运行可视化检测

~~~bash
python detect.py --model_path ./infer_models --images_path ./test --save_path ./output --device 0
~~~

* PS

模型问题：

这个模型我训了八版，前前后后大概两周，关键点数据集清洗了9k张来训练，过程中尝试过其他模型，但是尝试的模型感觉过于重了。但是mtcnn效果现在只能一般。

具体地，缺点体现在 1.不是特别偏的侧脸还好，一旦特别偏，要么检测框检测不上，要不检测上但是关键点特别偏。2.对于特别模糊的（极个别），即使正脸也可能检测不到（具体原因目前还不知道，我做了很多次新数据集来增加训练，但是效果不佳）

应用：

如果单独用它来判别正脸或者侧脸，我觉得肯定不行。但是，如果与原模型结合，可以在判断为正脸的基础上再使用它来计算欧拉角，进一步判断正侧脸（但是对于特别模糊的，比如night_woman_49号，存在上述问题，测试发现，大多被RNet过滤，可以修改RNet置信度，例如detect.py中line290 中的thres，可以修改为0.0，但是效果有提升但是提升不大，代价就是时间会增加），识别上的脸的关键点挺准的

如果将它用在展示上，还是可行的，detect中包含可视化部分，可以做一个展示。











